DONE:
-- implement generic float/double | OK
-- M constant in futhark and M variable in cuda | OK
-- clean up cuda code | OKish I guess

TODO:
-- XLA get cuda buffers? 
-- futhark cuda --library?
-- validate futhark solution
-- version that uses shared memory: inner dim < 1024